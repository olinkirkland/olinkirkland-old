<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Drawing &amp; Layers - Olin Kirkland</title><meta name="description" content="Reimplementing the Layers Pane was easier than I expected. I had a lot of work done from before and was&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://olinkirk.land/drawing-and-layers/"><link rel="alternate" type="application/atom+xml" href="https://olinkirk.land/feed.xml"><link rel="alternate" type="application/json" href="https://olinkirk.land/feed.json"><meta property="og:title" content="Drawing & Layers"><meta property="og:image" content="https://olinkirk.land/media/posts/17/chrome_2021-06-18_10-16-50.jpg"><meta property="og:site_name" content="Olin Kirkland"><meta property="og:description" content="Reimplementing the Layers Pane was easier than I expected. I had a lot of work done from before and was&hellip;"><meta property="og:url" content="https://olinkirk.land/drawing-and-layers/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@itsolinkirkland"><meta name="twitter:title" content="Drawing & Layers"><meta name="twitter:description" content="Reimplementing the Layers Pane was easier than I expected. I had a lot of work done from before and was&hellip;"><meta name="twitter:image" content="https://olinkirk.land/media/posts/17/chrome_2021-06-18_10-16-50.jpg"><link rel="shortcut icon" href="https://olinkirk.land/media/website/icons8-traveler-90.png" type="image/png"><link rel="shortcut icon" href="https://olinkirk.land/media/website/icons8-traveler-90.png" type="image/png"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://olinkirk.land/assets/css/style.css?v=c90c49b2f3e35b54180452dc9eb8b947"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://olinkirk.land/drawing-and-layers/"},"headline":"Drawing & Layers","datePublished":"2021-06-18T10:14","dateModified":"2021-06-18T10:32","image":{"@type":"ImageObject","url":"https://olinkirk.land/media/posts/17/chrome_2021-06-18_10-16-50.jpg","height":964,"width":1445},"description":"Reimplementing the Layers Pane was easier than I expected. I had a lot of work done from before and was&hellip;","author":{"@type":"Person","name":"Olin Kirkland"},"publisher":{"@type":"Organization","name":"Olin Kirkland"}}</script></head><body><header class="header" id="js-header"><a href="https://olinkirk.land/" class="logo">Olin Kirkland</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">[MISSING TRANSLATION]</span></span></button><ul class="navbar__menu"><li><a href="https://olinkirk.land/" target="_self">Home</a></li><li><a href="https://olinkirk.land/about/" target="_self">About</a></li><li><a href="https://olinkirk.land/games-and-apps/" target="_self">Games and Apps</a></li><li><a href="https://olinkirk.land/exhibits/" target="_self">Exhibits</a></li><li><a href="https://olinkirk.land/tag/blog/" target="_self">Blog</a></li></ul></nav></header><main><div class="wrapper"><article class="post"><header class="post__header"><a href="https://olinkirk.land/tag/worldmaker/" class="post__maintag">Worldmaker</a><h1 class="post__title">Drawing &amp; Layers</h1><div class="post__meta"><time datetime="2021-06-18T10:14">June 18, 2021</time></div></header><figure class="post__featured-image"><img src="https://olinkirk.land/media/posts/17/chrome_2021-06-18_10-16-50.jpg" srcset="https://olinkirk.land/media/posts/17/responsive/chrome_2021-06-18_10-16-50-xs.jpg 300w, https://olinkirk.land/media/posts/17/responsive/chrome_2021-06-18_10-16-50-sm.jpg 480w, https://olinkirk.land/media/posts/17/responsive/chrome_2021-06-18_10-16-50-md.jpg 768w, https://olinkirk.land/media/posts/17/responsive/chrome_2021-06-18_10-16-50-lg.jpg 1200w" sizes="(min-width: 56.25em) 100vw, (min-width: 37.5em) 50vw, 100vw" loading="eager" height="964" width="1445" alt=""></figure><div class="post__inner"><div class="post__entry"><p>Reimplementing the Layers Pane was easier than I expected. I had a lot of work done from before and was able to copy most of the code directly from the <a href="https://olinkirk.land/worldmaker/">previous iteration</a>.</p><p>The major difference for layers this time comes down to code structure. Instead of sending events to the Map class, this time the Layers Pane and the Map pane both directly access the layers ArrayCollection that's created and stored in the TaskManager's currentTask. Since it's a singleton, there's no difficulty keeping the Map and Layers Pane in sync.</p><p>The TaskManager itself keeps tabs on the ArrayCollection and dispatches events through the Signal singleton letting any listener to the Signal class know if a change to the Layers has occurred.</p><p>Each task only initially stores the unique IDs of the layers that are to be displayed for that task. The actual Layer objects are initialized when the <code>resetLayers()</code> function is called (at the end of each Task class constructor). This function is also called when the layers are reset (returned to their original visibility and arrangement).</p><pre>public function resetLayers():void<br>{<br>    layers.removeAll();<br>    for each (var l:String in _layerIds)<br>    {<br>        var layer:Layer = new Layer();<br>        layer.id = l;<br>        layer.visible = true;<br>        layer.allowed = true;<br>        layers.addItem(layer);<br>    }<br>}</pre><figure class="post__image"><img loading="lazy" src="https://olinkirk.land/media/posts/17/adl_2021-06-18_10-25-29.png" sizes="(max-width: 48em) 100vw, 100vw" srcset="https://olinkirk.land/media/posts/17/responsive/adl_2021-06-18_10-25-29-xs.png 300w, https://olinkirk.land/media/posts/17/responsive/adl_2021-06-18_10-25-29-sm.png 480w, https://olinkirk.land/media/posts/17/responsive/adl_2021-06-18_10-25-29-md.png 768w" alt="" width="469" height="205"><figcaption>Finally, a functional layers pane for the new build</figcaption></figure><p>Drawing the map itself takes on a different approach as well. The <code>onDraw(event)</code> function contains a switch by layer id, and loops over each layer in the currentTask's Layers ArrayCollection. I decided to separate the act of drawing each layer into individual functions dedicated to that particular layer's visualization.</p><pre>for each (var layer:Layer in layers)<br>{<br>    if (!layer.visible)<br>        continue;<br><br>    switch (layer.id)<br>    {<br>        case Layer.POINTS:<br>            drawPoints();<br>            break;<br>        case Layer.VORONOI:<br>            drawVoronoi();<br>            break;<br>        case Layer.DELAUNAY:<br>            drawDelaunay();<br>            break;<br>        case Layer.TECTONIC_PLATES:<br>            drawTectonics();<br>            break;<br>    }<br>}</pre><p>If a new layer is to be added to some task, the easy scalability of this approach makes it very straightforward to expand tasks without needing to delve deep into existing code.</p></div><footer><div class="post__tags-share"><ul class="post__tag"><li><a href="https://olinkirk.land/tag/blog/">Blog</a></li><li><a href="https://olinkirk.land/tag/worldmaker/">Worldmaker</a></li></ul><aside class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Folinkirk.land%2Fdrawing-and-layers%2F" class="js-share facebook" aria-label="Share with Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://olinkirk.land/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Folinkirk.land%2Fdrawing-and-layers%2F&amp;via=%40itsOlinKirkland&amp;text=Drawing%20%26%20Layers" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://olinkirk.land/assets/svg/svg-map.svg#twitter"/></svg></a></aside></div><nav class="post__nav"><div class="post__nav__prev"><a class="post__nav__link" href="https://olinkirk.land/code-structure-and-state-management/" rel="prev">Previous Post<h3 class="h6">Code Structure &amp; State Management</h3></a></div></nav></footer></div></article></div></main><footer class="footer"><div class="footer__social"><a href="https://twitter.com/itsOlinKirkland" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://olinkirk.land/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.instagram.com/olinkirkland/" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://olinkirk.land/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/olin-kirkland-10483078/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://olinkirk.land/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">&copy; 2020 Olin Kirkland | Made with Publii Open-Source CMS</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://olinkirk.land/assets/js/scripts.min.js?v=8b3e67b51e8c7a7d51b33f4a94ae4287"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><script id="dsq-count-scr" src="https://olinkirkland.disqus.com/count.js" async></script></body></html>